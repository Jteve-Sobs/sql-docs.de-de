---
title: Integritätsregeln (PowerPivot für SharePoint)-Referenz | Microsoft-Dokumentation
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 47ae04ce-7b9d-49c2-8dbc-bafcb73d4603
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: 60d8599942db1c7f1ff679d92de496692ed2d58b
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/15/2019
ms.locfileid: "66071401"
---
# <a name="health-rules-reference-powerpivot-for-sharepoint"></a>Referenz zu Integritätsregeln (PowerPivot für SharePoint)
  In diesem Referenzthema werden die SharePoint-Integritätsregeln beschrieben, die durch eine PowerPivot für SharePoint-Installation hinzugefügt werden. Diese Regeln werden verwendet, um Probleme mit dem Serverzustand, der Verfügbarkeit oder der Konfiguration einer [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] -Dienstanwendung bzw. einer zugeordneten [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] -Instanz zu melden.  
  
 In der folgenden Tabelle werden die Regeln in der Reihenfolge aufgeführt, in der sie in der SharePoint-Zentraladministration auf der Seite Regeldefinitionen der Integritätsanalyse angezeigt werden. Bei konfigurierbaren Regeln können Sie die Schwellenwerte ändern, bei denen die Regel ausgelöst wird. Weitere Informationen finden Sie unter [PowerPivot-Integritätsregeln − konfigurieren](configure-power-pivot-health-rules.md). Unter "Automatische Reparatur" wird angegeben, ob es eine integrierte Abhilfemaßnahme gibt. Falls ja, können Sie auf der Seite der Problemberichte auf diese klicken, um das Problem zu beheben.  
  
||  
|-|  
|**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013 &#124; SharePoint 2010|  
  
 **Hinweis:** [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] werden verschiedene Sätze von Integritätsregeln für unterschiedliche SharePoint-Versionen installiert. Finden Sie unter der Spalte "Version" in der folgenden Tabelle, oder Sie können auf der installierten Regeln finden Sie unter den folgenden Windows PowerShell-Befehl ausführen.  
  
```  
Get-SPHealthAnalysisRule | select name, enabled, summary | where {$_.summary -like "*power*"}  | format-table -property * -autosize | out-default  
```  
  
|Rule|Konfigurierbar|Automatische Reparatur|Version|Description|  
|----------|------------------|-----------------|-------------|-----------------|  
|PowerPivot: Der Analysis Services OLE DB-Anbieter ist auf diesem Computer nicht installiert.|Nein|Nein|SharePoint 2010|Der OLE DB-Anbieter für Analysis Services ist entweder auf dem Server nicht installiert oder weist die falsche Version auf. Diese Regel wird angezeigt, wenn die SharePoint-Farm Instanzen von Excel Services auf Anwendungsservern enthält, für die PowerPivot für SharePoint nicht verfügbar ist. Die Regel warnt Sie, dass der OLE DB-Anbieter für Analysis Services nicht installiert ist, der von Excel Services zum Herstellen einer Verbindung mit PowerPivot-Daten verwendet wird. Um dieses Problem zu beheben, installieren Sie den OLE DB-Anbieter auf jedem Excel Services-Server, auf dem der OLE DB-Anbieter für Analysis Services nicht vorhanden ist. Sie können den OLE DB-Anbieter für Analysis Services im Microsoft Download Center herunterladen und installieren. Weitere Informationen finden Sie unter [Installieren des OLE DB-Anbieters für Analysis Services auf SharePoint-Servern](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).|  
|PowerPivot: Registrierungseinstellungen für "Microsoft.AnalysisServices.channeltransport.dll" sind nicht gültig, nachdem Sie die SQL Server 2008 R2-Version des MSOLAP-Anbieters auf diesem Computer installiert.|Nein|Ja|SharePoint 2010|Dies ist ein Serverkonfigurationsproblem. Höchstwahrscheinlich wurde die Datei "ChannelTransport.dll" nicht in der globalen Assembly registriert. Führen Sie die automatische Reparatur für diese Regel aus, um die .dll-Datei auf jedem Server zu registrieren, auf dem PowerPivot für SharePoint installiert ist. Alternativ können Sie "regasm.exe" ausführen, um die Datei manuell zu registrieren. Wenn Sie den SharePoint-Timerdienst nicht als lokaler Administrator ausführen, ist ggf. eine manuelle Registrierung erforderlich. Wenn Sie die Registrierungseinstellungen nicht aktualisieren, hat dies eine langsamere Serverkommunikation zwischen Excel Services und dem PowerPivot-Systemdienst zur Folge, was in bestimmten Sicherheitskonfigurationen Verbindungsfehler auslösen kann.|  
|PowerPivot: PowerPivot-dienstanwendung verfügt nicht über die Berechtigung für den Vorgang.|Nein|Nein|SharePoint 2010|Diese Regel überprüft, ob die PowerPivot-Dienstanwendungsidentität Datenbankbesitzer der PowerPivot-Serveranwendungsdatenbank ist und über Administratorberechtigungen für die lokale SQL Server Analysis Services-Instanz verfügt. Diese Berechtigungen werden während der Installation und Bereitstellung automatisch gewährt. Wenn dieser Schritt jedoch nicht abgeschlossen wurde, tritt diese Integritätsregel ein.|  
|PowerPivot: Die PowerPivot-dienstanwendungsidentität sollte nicht Mitglied der lokalen Gruppe "Administratoren" sein.|Nein|Nein|SharePoint 2010|Dies ist eine Best Practice, die die Gesamtsicherheit der Bereitstellung verbessert. Wenn Sie die PowerPivot-Dienstanwendung so konfiguriert haben, dass sie unter einem Konto der lokalen Administratorgruppe ausgeführt werden soll, sollten Sie das Dienstkonto in ein Konto ändern, der nicht zu dieser Gruppe gehört. Es wird empfohlen, ein spezielles Konto mit möglichst wenigen Berechtigungen für jeden Dienst zu verwenden. Sie erzielen so eine Dienstisolation und vereinfachen die Überwachung von Anmeldungen. Weitere Informationen zum Ändern des Dienstkontos finden Sie unter [Konfigurieren von PowerPivot-Dienstkonten](configure-power-pivot-service-accounts.md).|  
|PowerPivot: Die Analysis Services-Instanz, die im tabellarischen Modus ausgeführt wird, aber die Konfigurationseinstellung, die in diesem Modus gibt an, deaktiviert ist.|Nein|Nein|SharePoint 2010|Diese Regel überprüft, ob in der SQL Server Analysis Services-Instanz in einer PowerPivot für SharePoint-Installation die `DeploymentMode`-Servereigenschaft auf 1 festgelegt ist. Wenn die Eigenschaft auf einen anderen Wert festgelegt ist oder wenn der SharePoint-Timerdienst, der die Regelprüfung ausführt, nicht über die Berechtigung zum Öffnen der Datei verfügt, schlägt diese Regel fehl. Weitere Informationen zur Bereitstellungsmoduseigenschaft finden Sie unter [Bestimmen des Servermodus einer Analysis Services-Instanz](../instances/determine-the-server-mode-of-an-analysis-services-instance.md).|  
|PowerPivot: Die Daten Zeitgeberauftrag PowerPivot Datenaktualisierung ist deaktiviert.|Nein|Nein|SharePoint 2013<br /><br /> SharePoint 2010|Überprüfen Sie die Einstellungen für den Zeitgeberauftrag, um sicherzustellen, dass dieser aktiviert wurde. Wenn Sie die PowerPivot-Datenaktualisierungsfunktion nicht verwenden, können Sie diese Regel ignorieren. Weitere Informationen finden Sie unter [PowerPivot-Datenaktualisierung mit SharePoint 2010](../powerpivot-data-refresh-with-sharepoint-2010.md).|  
|PowerPivot: Die SQL Server Analysis Services (PowerPivot)-Dienstkontoinformationen, die von der SQL Server-Konfigurations-Manager verwaltet wird, unterscheidet sich von den Kontoinformationen, der von der zentralen Verwaltung verwaltet wird.|Nein|Nein|SharePoint 2010|Diese Regel überprüft, ob die Dienstkontoinformationen im SQL Server-Konfigurations-Manager mit den Informationen des verwalteten Kontos in der Zentraladministration für die gleiche Analysis Services-Instanz übereinstimmen. Wenn sich die Konten unterscheiden, wird dem Problem- und Lösungsbericht ein Eintrag hinzugefügt, damit Sie die Dienstkontoinformationen im SQL Server-Konfigurations-Manager auf das in der Zentraladministration angegebene Konto zurücksetzen können. Der SQL Server-Konfigurations-Manager ist kein unterstütztes Tool zum Ändern des Benutzernamens und Kennworts von Dienstkonten in einer PowerPivot für SharePoint-Installation. Bei Verwendung der Zentraladministration kann die Funktion für verwaltete Konten von SharePoint genutzt werden. Wenn die Farm mehrere PowerPivot für SharePoint-Server beinhaltet, können inkonsistente Dienstkontoeinstellungen die Verarbeitungs- und Abfrageoperationen auf dem Server mit den falschen Dienstinformationen beeinträchtigen.<br /><br /> Wenn diese Regel ausgelöst wurde, können auf einem einzelnen Server PowerPivot-Arbeitsmappen vorübergehend genutzt werden. Es wird jedoch empfohlen, das Problem so schnell wie möglich zu beheben. Datenbank- und Dateisystemberechtigungen werden anhand der Kontoinformationen in der Zentraladministration aktualisiert.|  
|PowerPivot: Die bereitgestellte farmlösung ist nicht auf dem neuesten Stand.|Nein|Ja|SharePoint 2010|Eine PowerPivot für SharePoint-Installation verwendet eine Lösung auf Farmebene und eine Lösung auf Webanwendungsebene, um die Funktionen zu installieren. Diese Regel gibt an, dass die Farmlösung relativ zur Version, dem Server oder möglicherweise der Weblösung nicht aktuell ist. Höchstwahrscheinlich handelt es sich hierbei um ein Serverbereitstellungsproblem. Zur Behebung dieses Problems können Sie das SQL Server-Setup ausführen, um eine der PowerPivot für SharePoint-Installationen in der Farm zu reparieren. Weitere Informationen zu Lösungen in einer PowerPivot für SharePoint-Installation finden Sie unter [Bereitstellen der PowerPivot-Lösungen in SharePoint](deploy-power-pivot-solutions-to-sharepoint.md).|  
|PowerPivot: CPU-Auslastung-Gesamtauslastung ist zu hoch.|Ja|Nein|SharePoint 2010|Diese Regel meldet den CPU-Verbrauch auf Systemebene. Die CPU-Gesamtauslastung wird überwacht, da der PowerPivot-Systemdienst diese als Measure des Serverstatus für den zustandsbasierten Lastenausgleich auf mehreren PowerPivot für SharePoint-Servern in einer Farm verwendet. Erwägen Sie, der Farm einen weiteren Anwendungsserver hinzuzufügen und CPU-intensive Anwendungen auf diesen Server zu verschieben.|  
|PowerPivot: Analysis Services verfügt nicht über genügend CPU-Ressourcen, um die angeforderten Vorgänge auszuführen.|Ja|Nein|SharePoint 2010|Die Menge der verfügbaren CPU-Ressourcen für den Analysis Services-Prozess (msmdsrv.exe) reicht für den Grad der Aktivität auf diesem Server nicht aus. Erwägen Sie, der Farm einen weiteren PowerPivot für SharePoint-Server hinzuzufügen. Weitere Informationen finden Sie unter [Checkliste für die Bereitstellung: Horizontale Skalierung durch Hinzufügen von PowerPivot-Server zu einer SharePoint 2010-Farm](../../sql-server/install/deployment-checklist-scale-out-adding-powerpivot-servers-sharepoint-2010-farm.md).|  
|PowerPivot: Analysis Services verfügt nicht über genügend Arbeitsspeicher, um die angeforderten Vorgänge auszuführen.|Nein|Nein|SharePoint 2010|Diese Regel wird ausgelöst, wenn nur noch 5 % des Speichers für Analysis Services verfügbar ist. Auf einem SharePoint-Anwendungsserver sollte eine SQL Server Analysis Services-Instanz immer über einen kleinen Arbeitsspeicher als Reserve verfügen, der nie verwendet wird. Da der Server für die meisten Vorgänge arbeitsspeichergebunden ist, läuft er am besten, wenn er nicht ganz bis zur oberen Grenze ausgeführt wird.<br /><br /> Standardmäßig werden Warnungen aufgrund von unzureichendem Arbeitsspeicher ausgegeben, wenn der verfügbare Speicher auf 5 % gefallen ist. Sie können diesen Wert in einen höheren oder niedrigeren Wert ändern, indem Sie die Einstellungen für die Analysis Services-Instanz anpassen. Weitere Informationen finden Sie unter [PowerPivot-Integritätsregeln − konfigurieren](configure-power-pivot-health-rules.md).<br /><br /> Die 5 % nicht verwendeter Arbeitsspeicher werden als Prozentsatz des Arbeitsspeichers berechnet, der den Analysis Services zugeordnet wird. Wenn der gesamte Speicher z. B. 200 GB beträgt und Analysis Services davon 80 % (oder 160 GB) belegt, dann entsprechen die 5 % nicht verwendeter Speicher 5 % von 160 GB (oder 8 GB).|  
|PowerPivot: Die hohe Verbindungsanzahl weist darauf hin, dass weitere Server zur Bewältigung der aktuellen Arbeitslast bereitgestellt werden soll.|Ja|Nein|SharePoint 2010|Standardmäßig wird diese Integritätsregel ausgelöst, wenn die Anzahl einzelner Benutzerverbindungen 100 überschreitet. Dieser Standardwert ist ein beliebiger Wert (basiert nicht auf den Hardwarespezifikationen des Servers oder auf der Benutzeraktivität), damit Sie den Wert abhängig von der Serverkapazität und Benutzeraktivität in der Umgebung herauf- oder herabsetzen können. Weitere Informationen finden Sie unter [PowerPivot-Integritätsregeln − konfigurieren](configure-power-pivot-health-rules.md).|  
|PowerPivot: Das Verhältnis von ladeereignissen Verbindungen ist zu hoch.|Ja|Nein|SharePoint 2013<br /><br /> SharePoint 2010|Standardmäßig wird diese Integritätsregel ausgelöst, wenn der Prozentsatz der Ladeereignissen im Verhältnis zu Verbindungsereignissen im Verlauf des ganzen Datensammlungszeitraums (standardmäßig 4 Stunden) 50 % überschreitet. Ein Verhältnis in dieser Höhe deutet auf eine sehr hohe Anzahl von Verbindungen zu eindeutigen Arbeitsmappen oder auf zu drastische Cachereduzierungseinstellungen hin (Arbeitsmappen werden schnell entladen und aus dem System entfernt, während Anforderungen für diese Daten noch aktiv sind). Um falsche Positivmeldungen zu vermeiden, müssen in einem Zeitraum von 4 Stunden mindestens 20 Verbindungen vorhanden sein, damit das Verhältnis berechnet werden kann. Sie können als Grundlage dieser Integritätsregel auch ein anderes Verhältnis festlegen. Weitere Informationen finden Sie unter [PowerPivot-Integritätsregeln − konfigurieren](configure-power-pivot-health-rules.md). Weitere Informationen zum Konfigurieren des Caches finden Sie unter [Konfigurieren der Speicherplatzverwendung &#40;PowerPivot für SharePoint&#41;](configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|PowerPivot: Mindestens eine Minidump-Dateien wurden in das Protokollverzeichnis, was auf einen Programmabsturz gefunden.|Nein|Nein|SharePoint 2013<br /><br /> SharePoint 2010|Während eines Programmabsturzes werden Minidump-Dateien generiert, um Informationen über den Status der PowerPivot-Dienstanwendung kurz vor dem Absturz zu erfassen. Diese Informationen können an Microsoft gesendet und für die Problembehandlung verwendet werden. Diese Regel wird ausgelöst, wenn .dmp-Dateien auf dem Server erkannt werden. Die Regel stellt einen Link zu der Datei bereit, die sich im Ordner "\OLAP\Log" der PowerPivot für SharePoint-Instanz befindet. Beachten Sie, dass Sie den Inhalt der Datei nicht mithilfe eines Texteditors anzeigen können. Um eine Minidump-Datei anzuzeigen, müssen Sie ein separates Debugtool herunterladen und installieren. Weitere Informationen finden Sie unter [Debugtools für Windows](/windows-hardware/drivers/debugger/).|  
|PowerPivot: Speicherplatz auf dem Datenträger weist nicht genügend das Laufwerk auf dem PowerPivot-Daten zwischengespeichert werden.|Ja|Nein|SharePoint 2010|Standardmäßig wird diese Integritätsregel ausgelöst, wenn der Speicherplatz auf dem Laufwerk mit dem Sicherungsordner geringer als 5 % ist. Weitere Informationen zum Festlegen dieses Prozentsatzes finden Sie unter [PowerPivot-Integritätsregeln − konfigurieren](configure-power-pivot-health-rules.md). Weitere Informationen zur datenträgernutzung finden Sie unter [Konfigurieren der Speicherplatzverwendung &#40;PowerPivot für SharePoint&#41;](configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|PowerPivot: Verwendungsdaten werden nicht mit der erwarteten Häufigkeit aktualisiert.|Ja|Nein|SharePoint 2013<br /><br /> SharePoint 2010|PowerPivot für SharePoint erfasst Metriken zur Datenaktualisierung, zu Verbindungen und Abfrageantwortzeiten mithilfe des integrierten Systems für die Sammlung von Verwendungsdaten. Diese Verwendungsdaten werden in der PowerPivot-Dienstanwendungsdatenbank gespeichert, die dann wiederum zum Aktualisieren einer PowerPivot-Arbeitsmappe (PowerPivot Management Data.xlsx) dient, die Daten für Berichte im PowerPivot-Management-Dashboard bereitstellt. Diese Regel gibt an, dass Verwendungsdaten nicht mit ausreichender Häufigkeit in die Datei "PowerPivot Management Data.xlsx" verschoben werden. Die Regel verwendet den Zeitstempel in der XLSX-Datei als Nachweis, dass die Datei aktualisiert wurde. Weitere Probleme im Verwendungsdatensammlungssystem, die die Genauigkeit der Daten beeinträchtigen, werden durch diese Regel nicht erkannt. Überprüfen Sie zum Beheben dieses Fehlers, ob die Zeitgeberaufträge ausgeführt werden. Weitere Informationen zur Sammlung von Verwendungsdaten finden Sie unter [konfigurieren Sammlung von Verwendungsdaten für &#40;PowerPivot für SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md).|  
|PowerPivot: Das midtier-Prozesskonto sollte Berechtigung 'Alles lesen' für alle zugeordneten SPWebApplications besitzen.|Nein|Ja|SharePoint 2013<br /><br /> SharePoint 2010|Die PowerPivot-dienstanwendungsidentität benötigen **alles lesen** verfügen, um den Zugriff von der SharePoint-Inhaltsdatenbanken im Auftrag von Benutzern, die Berechtigung für ein Dokument verfügen. Um zu bestimmen, welches Konto als die PowerPivot-dienstanwendungsidentität verwendet wird, öffnen Sie die **Dienstkonten konfigurieren** Seite in der Zentraladministration. Höchstwahrscheinlich wird die Dienstanwendung entweder im Dienstanwendungspool des **SharePoint-Webdienstsystems** oder einem dedizierten Anwendungspool ausgeführt. Obwohl diese Regel Möglichkeit einer automatischen Reparatur bietet, erhalten Sie bessere Ergebnisse, wenn Sie die Berechtigungen manuell gewähren, indem Sie wie folgt vorgehen:<br /><br /> 1) Klicken Sie in der Zentraladministration auf **Webanwendungen verwalten**.<br /><br /> 2) Wählen Sie eine Website aus, und klicken Sie anschließend auf **Benutzerrichtlinie**.<br /><br /> 3) Klicken Sie auf **Benutzer hinzufügen**.<br /><br /> 4) Wählen Sie (Alle-Zonen) aus, und klicken Sie auf **Weiter**.<br /><br /> (5) Benutzer, geben Sie die PowerPivot-dienstanwendungsidentität ein, und klicken Sie dann auf die **alles lesen** Kontrollkästchen. Klicken Sie auf **Fertig stellen**.<br /><br /> 6) Überprüfen Sie die Reparatur. Klicken Sie in Monitoring auf **Regeldefinitionen überprüfen**. Suchen und öffnen Sie dann die PowerPivot-Regel. Klicken Sie auf **Jetzt ausführen**. Gehen Sie zurück zu **Probleme und Lösungen überprüfen** , um sicherzustellen, dass die Regel nicht mehr angezeigt wird.|  
|PowerPivot: Der sekundäre Anmeldedienst (Seclogon) ist deaktiviert.|Nein|Nein|SharePoint 2013<br /><br /> SharePoint 2010|Der sekundäre Anmeldedienst wird verwendet, um Miniaturbilder der PowerPivot-Arbeitsmappen im PowerPivot-Katalog zu generieren. Standardmäßig ist der sekundäre Anmeldedienst auf manuellen Start festgelegt. Wenn der Dienst deaktiviert ist, tritt beim Generieren von Miniaturansichten ein Fehler auf. Darüber hinaus werden die ULS-Protokolle die Fehlermeldung enthalten: "Der Fehler 1058 haben liegene Ursache der Tatsache der Windows-Dienst, der"Sekundäre Anmeldung"deaktiviert ist."<br /><br /> Um die Dienstkonfiguration zu überprüfen, verwenden Sie die Konsolenanwendungsdienste, um Sekundäre Anmeldung zu suchen und deren **Starttyp** in **Manuell**zu ändern. Wenn Sie den Dienst nicht aktivieren können, verfügt Ihre Organisation möglicherweise über eine Gruppenrichtlinie zum Deaktivieren. Fragen Sie einen Administrator, ob dies der Fall ist.<br /><br /> Wenn Sie den Dienst aktiviert haben, werden die Miniaturansichts- oder Momentaufnahmebilder nach und nach aktualisiert. Sie können auch eine Aktualisierung erzwingen, indem Sie den Dienst erneut starten und dann die Eigenschaftenseiten eines bestimmten Berichts öffnen und erneut speichern. Weitere Informationen finden Sie unter [verwenden PowerPivot-Katalogs](https://go.microsoft.com/fwlink/?LinkId=246462).|  
|PowerPivot: ADOMD.NET ist nicht auf einem eigenständigen WFE installiert, die für die Zentraladministration konfiguriert ist|Nein|Nein|SharePoint 2013<br /><br /> SharePoint 2010|ADOMD.NET ist eine Analysis Services-Clientbibliothek, die Verbindungen mit einer Analysis Services-Datenbank unterstützt. In einer Bereitstellung von PowerPivot für SharePoint ermöglicht ADOMD.NET den Zugriff auf die integrierten Berichte im PowerPivot-Management-Dashboard der Zentraladministration. Integrierte Berichte sind eigentlich PowerPivot-Arbeitsmappen, die eingebettete Analysis Services-Daten enthalten. Das Management-Dashboard sendet mithilfe von ADOMD.NET eine Verbindungsanforderung an den Server, der in der Arbeitsmappe enthaltene Daten lädt.<br /><br /> In Topologien mit Zentraladministration, die auf einem eigenständigen Web-Front-End-Server ausgeführt wird, müssen Sie ADOMD.NET manuell installieren, wenn Sie diese Berichte im Management-Dashboard anzeigen möchten. Weitere Informationen finden Sie unter [Installieren von ADOMD.NET auf Web-Front-End-Servern, auf denen die Zentraladministration ausgeführt wird](../../sql-server/install/install-adomd-net-on-web-front-end-servers-running-central-administration.md).|  
  
  
