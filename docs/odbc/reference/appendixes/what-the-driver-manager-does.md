---
title: Was der Treiber-Manager tut | Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC], backward compatibility
- compatibility [ODBC], driver manager
- ODBC driver manager [ODBC]
- backward compatibility [ODBC], driver manager
ms.assetid: 57f65c38-d9ee-46c8-9051-128224a582c6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 07ab0784e6f6ad4487a02a179a5fa3be2617c930
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/14/2020
ms.locfileid: "81306561"
---
# <a name="what-the-driver-manager-does"></a>Funktionen des Treiber-Managers
Die folgende Tabelle fasst zusammen, wie der ODBC *3.x* Driver Manager Aufrufe von ODBC *2.x-* und ODBC *3.x-Treibern* zuordnet.  
  
|Funktion oder<br /><br /> Anweisungsattribut|Kommentare|  
|-----------------------------------------|--------------|  
|SQL_ATTR_FETCH_BOOKMARK_PTR|Zeigt auf das Lesezeichen, das mit **SQLFetchScroll**verwendet werden soll. Im Folgenden sind Implementierungsdetails zu finden:<br /><br /> - Wenn eine Anwendung dies in einem ODBC *2.x-Treiber* festlegt, speichert der ODBC *3.x* Driver Manager ihn zwischen. Der Verweis auf den Zeiger wird dereferenziert und der Wert an den ODBC *2.x-Treiber* im *FetchOffset-Argument* von **SQLExtendedFetch** übergibt, wenn **SQLFetchScroll** später von der Anwendung aufgerufen wird.<br />- Wenn eine Anwendung dies in einem ODBC *3.x-Treiber* festlegt, gibt der ODBC *3.x* Driver Manager den Aufruf an den Treiber weiter.|  
|SQL_ATTR_ROW_STATUS_PTR|Verweist auf das Zeilenstatusarray, das von **SQLFetch**, **SQLFetchScroll**, **SQLBulkOperations**und **SQLSetPos**gefüllt wird. Im Folgenden sind Implementierungsdetails zu finden:<br /><br /> - Wenn eine Anwendung dies in einem ODBC *2.x-Treiber* festlegt, speichert der ODBC *3.x* Driver Manager seinen Wert zwischen. Dieser Wert wird an den ODBC *2.x-Treiber* im *RowStatusArray-Argument* von **SQLExtendedFetch** übergibt, wenn **SQLFetchScroll** oder **SQLFetch** aufgerufen wird.<br />- Wenn eine Anwendung dies in einem ODBC *3.x-Treiber* festlegt, gibt der ODBC *3.x* Driver Manager den Aufruf an den Treiber weiter.<br />- Wenn eine Anwendung im Status S6 SQL_ATTR_ROW_STATUS_PTR festlegt und dann **SQLBulkOperations** (mit einem *Vorgang* von SQL_ADD) oder **SQLSetPos** aufruft, ohne zuvor **SQLFetch** oder **SQLFetchScroll**aufzurufen, wird SQLSTATE HY011 (Attribut kann jetzt nicht festgelegt werden) zurückgegeben.|  
|SQL_ATTR_ROWS_FETCHED_PTR|Punkte auf den Puffer, in dem **SQLFetch** und **SQLFetchScroll** die Anzahl der abgerufenen Zeilen zurückgeben. Im Folgenden sind Implementierungsdetails zu finden:<br /><br /> - Wenn eine Anwendung dies in einem ODBC *2.x-Treiber* festlegt, speichert der ODBC *3.x* Driver Manager seinen Wert zwischen. Dieser Wert wird an den ODBC *2.x-Treiber* im *RowCountPtr-Argument* von **SQLExtendedFetch** übergibt, wenn **SQLFetch** oder **SQLFetchScroll** von der Anwendung aufgerufen wird.<br />- Wenn eine Anwendung dies in einem ODBC *3.x-Treiber* festlegt, gibt der ODBC *3.x* Driver Manager den Aufruf an den Treiber weiter.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Legt die Rowsetgröße fest. Im Folgenden sind Implementierungsdetails zu finden:<br /><br /> - Wenn eine Anwendung dies in einem ODBC *2.x-Treiber* festlegt, ordnet der ODBC *3.x* Driver Manager sie dem attribut SQL_ROWSET_SIZE-Anweisung zu.<br />- Wenn eine Anwendung dies in einem ODBC *3.x-Treiber* festlegt, gibt der ODBC *3.x* Driver Manager den Aufruf an den Treiber weiter.<br />- Wenn eine Anwendung, die mit einem ODBC *3.x-Treiber* arbeitet, **SQLSetScrollOptions**aufruft, wird SQL_ROWSET_SIZE auf den Wert im *RowsetSize-Argument* festgelegt, wenn der zugrunde liegende Treiber **SQLSetScrollOptions**nicht unterstützt.|  
|SQL_ROWSET_SIZE|Legt die Rowsetgröße fest, die von **SQLExtendedFetch** verwendet wird, wenn **SQLExtendedFetch** von einer ODBC *2.x-Anwendung* aufgerufen wird. Im Folgenden sind Implementierungsdetails zu finden:<br /><br /> - Wenn eine Anwendung dies festlegt, gibt der ODBC *3.x* Driver Manager den Anruf an den Treiber weiter, unabhängig von der Treiberversion.<br />- Wenn eine Anwendung, die mit einem ODBC *2.x-Treiber* arbeitet, **SQLSetScrollOptions**aufruft, wird SQL_ROWSET_SIZE auf den Wert im **RowsetSize-Argument** festgelegt.|  
|**SQLBulkOperations**|Führt einen Einfügevorgang aus, oder aktualisiert, löscht oder ruft nach Lesezeichenvorgängen ab. Im Folgenden sind Implementierungsdetails zu finden:<br /><br /> - Wenn eine Anwendung **SQLBulkOperations** mit einem *Vorgang* von SQL_ADD in einem ODBC *2.x-Treiber* aufruft, ordnet der ODBC *3.x-Treiber-Manager* es **SQLSetPos** mit einem *Vorgang* von SQL_ADD zu.<br />- Wenn Sie mit einem ODBC *2.x-Treiber* arbeiten, der **SQLSetPos** nicht mit einem Vorgang von SQL_ADD unterstützt, wird **SQLSetPos** mit einem *Vorgang* von SQL_ADD **SQLBulkOperations** nicht mit einem *3.x* *Vorgang* von SQL_ADD zugeordnet. *Operation* Dies liegt daran, dass **SQLBulkOperations** nicht im Zustand S7 aufgerufen werden kann, der in ODBC *2.x* der einzige Status war, in dem **SQLSetPos** aufgerufen werden konnte.<br />- Wenn die Anwendung **SQLBulkOperations** mit einem *Vorgang* von SQL_ADD in einem ODBC *2.x-Treiber* aufruft, bevor **sie SQLFetchScroll**aufruft, gibt der ODBC *3.x-Treiber-Manager* einen Fehler zurück.|  
|**SQLExtendedFetch**|Gibt das angegebene Rowset zurück. Mit Ausnahme der soeben erwähnten Einschränkung übergibt der ODBC *3.x-Treiber-Manager* Aufrufe von **SQLExtendedFetch** an den Treiber, unabhängig von der Treiberversion.|  
|**SQLFetch**|Gibt das nächste Rowset zurück. Im Folgenden sind Implementierungsdetails zu finden:<br /><br /> - Wenn eine Anwendung **SQLFetch** in einem ODBC *2.x-Treiber* aufruft, ordnet der ODBC *3.x-Treiber-Manager* es **SQLExtendedFetch**zu. Das *FetchOrientation-Argument* von **SQLExtendedFetch** ist auf SQL_FETCH_NEXT festgelegt. Der Treiber-Manager verwendet den zwischengespeicherten Wert des SQL_ATTR_ROW_STATUS_PTR-Anweisungsattributs für das *RowStatusArray-Argument* und den zwischengespeicherten Wert des SQL_ATTR_ROWS_FETCHED_PTR-Anweisungsattributs für das *RowCountPtr-Argument.*<br />- Eine ODBC *3.x-Anwendung* kann Aufrufe von **SQLFetch** und **SQLFetchScroll** in einem ODBC *2.x-Treiber* mischen, da der ODBC *3.x-Treiber-Manager* **SQLFetch SQLFetch** **SQLExtendedFetch** zuordnet, wenn eine Anwendung sie in einem ODBC *2.x-Treiber* aufruft.<br />- Wenn ein ODBC *2.x-Treiber* **SQLExtendedFetch**nicht unterstützt, wird SQLFetch oder **SQLFetchScroll** im ODBC *3.x-Treiber-Manager* **sqlFetch** oder SQLFetchScroll nicht **SQLExtendedFetch** zugeordnet, wenn eine Anwendung sie in diesem Treiber aufruft. Wenn die Anwendung versucht, SQL_ATTR_ROW_ARRAY_SIZE auf einen Wert größer als 1 festzulegen, wird SQLSTATE HYC00 (Optionale Funktion nicht implementiert) zurückgegeben.<br />- Mit Ausnahme der soeben erwähnten Einschränkungen übergibt der ODBC *3.x* Driver Manager Aufrufe von **SQLFetch** an den Treiber, unabhängig von der Treiberversion.|  
|**SQLFetchScroll**|Gibt das angegebene Rowset zurück. Im Folgenden sind Implementierungsdetails zu finden:<br /><br /> - Wenn eine Anwendung **SQLFetchScroll** in einem ODBC *2.x-Treiber* aufruft, ordnet der ODBC *3.x-Treiber-Manager* es **SQLExtendedFetch**zu. Es verwendet den zwischengespeicherten Wert des SQL_ATTR_ROW_STATUS_PTR-Anweisungsattributs für das *RowStatusArray-Argument* und den zwischengespeicherten Wert des SQL_ATTR_ROWS_FETCHED_PTR-Anweisungsattributs für das *RowCountPtr-Argument.* Wenn das *FetchOrientation-Argument* in **SQLFetchScroll** SQL_FETCH_BOOKMARK ist, verwendet es den zwischengespeicherten Wert des SQL_ATTR_FETCH_BOOKMARK_PTR-Anweisungsattributs für das *FetchOffset-Argument* und gibt einen Fehler zurück, wenn das *FetchOffset-Argument* von **SQLFetchScroll** nicht 0 ist.<br />- Wenn eine Anwendung dies in einem ODBC *3.x-Treiber* aufruft, gibt der ODBC *3.x* Driver Manager den Aufruf an den Treiber weiter.|  
|**SQLSetPos**|Führt verschiedene positionierte Vorgänge aus. Der ODBC *3.x-Treiber-Manager* übergibt Aufrufe an **SQLSetPos** an den Treiber, unabhängig von der Treiberversion.|  
|**SQLSetScrollOptionen**|Wenn der Treiber-Manager **SQLSetScrollOptions** für eine Anwendung zuordnet, die mit einem ODBC *3.x-Treiber* arbeitet, der **SQLSetScrollOptions**nicht unterstützt, legt der Treiber-Manager die SQL_ROWSET_SIZE-Anweisungsoption und nicht das SQL_ATTR_ROW_ARRAY_SIZE-Anweisungsattribut auf das *RowsetSize-Argument* in **SQLSetScrollOption**fest. Daher kann **SQLSetScrollOptions** nicht von einer Anwendung verwendet werden, wenn mehrere Zeilen durch einen Aufruf von **SQLFetch** oder **SQLFetchScroll**abgerufen werden. Sie kann nur verwendet werden, wenn mehrere Zeilen durch einen Aufruf von **SQLExtendedFetch**abgerufen werden.|
